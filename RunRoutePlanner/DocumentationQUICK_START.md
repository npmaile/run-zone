# RunZone - Quick Start Guide

## What is RunZone?

RunZone is an iOS app that generates circular running routes. Pick a distance, get a route that brings you back to where you started. Simple!

## Features

- ‚úÖ **Auto-generate circular routes** (1-50km)
- ‚úÖ **Real-time GPS tracking** with pace monitoring
- ‚úÖ **Voice navigation** for turn-by-turn guidance
- ‚úÖ **Route analysis** (elevation, turns, surface types)
- ‚úÖ **Route customization** (adjust complexity)
- ‚úÖ **Dark mode** support
- ‚úÖ **HealthKit integration** (save workouts)
- ‚úÖ **Run history** with SwiftData

## Setup Instructions

### Prerequisites
- Xcode 15.0+
- iOS 17.0+ deployment target
- iPhone with GPS (or simulator for testing)

### Installation

1. **Clone/Open Project**
   ```bash
   # Project files are in /repo/
   cd /repo/
   open RunZone.xcodeproj  # (or your project file)
   ```

2. **Check Target Settings**
   - Select your project in Xcode
   - Select your target
   - General tab ‚Üí Display Name: "RunZone"
   - Deployment Target: iOS 17.0+

3. **Add Info.plist Keys** (if not present)
   ```xml
   <key>NSLocationWhenInUseUsageDescription</key>
   <string>RunZone needs your location to plan and track running routes</string>
   
   <key>NSLocationAlwaysAndWhenInUseUsageDescription</key>
   <string>RunZone tracks your runs even when the app is in the background</string>
   
   <key>NSMotionUsageDescription</key>
   <string>RunZone uses motion data to track your running activity</string>
   
   <key>CFBundleDisplayName</key>
   <string>RunZone</string>
   ```

4. **Build and Run**
   ```
   ‚åò + R  (or click Play button)
   ```

5. **Grant Permissions**
   - Allow location access when prompted
   - Motion & Fitness access (if prompted)

## Project Structure

### Current Files (All in `/repo/`)

**Core Files:**
- `ContentView.swift` - Main app screen
- `RoutePlanner.swift` - Route generation logic
- `LocationManager.swift` - GPS tracking
- `NavigationManager.swift` - Voice navigation
- `Constants.swift` - App configuration + colors

**Feature Files:**
- `MapView.swift` - Map display
- `RunHistoryView.swift` - Past runs
- `SettingsView.swift` - User settings
- `HealthKitManager.swift` - Health integration

**Data Files:**
- `Models.swift` - Data structures (Run, Split, WorkoutType)

**Documentation:**
- `Documentation/` - All markdown docs

### Recommended Structure (Future)
See `Documentation/PROJECT_ARCHITECTURE.md` for target organization.

## How It Works

### User Flow
```
1. App opens ‚Üí Shows map with your location
2. Select distance (e.g., 5km) and time (e.g., 30min)
3. Route preview generates automatically
4. Tap "Start Run" ‚Üí GPS tracking begins
5. Follow blue route line
6. Voice guidance announces turns
7. Stop run ‚Üí See summary ‚Üí Save to Health
```

### Technical Flow
```
User Input
    ‚Üì
RoutePlanner generates waypoints
    ‚Üì
MapKit fetches directions
    ‚Üì
Route displayed on map
    ‚Üì
User starts run
    ‚Üì
LocationManager tracks GPS
    ‚Üì
NavigationManager provides voice guidance
    ‚Üì
HealthKitManager saves workout
```

## Key Concepts

### Circular Routes
All routes return to the starting point. Generated by placing waypoints in a circle and connecting them via roads.

### Waypoints
Intermediate points along the route. More waypoints = more detailed/curvy route. Range: 3-12.

### Route Preview
Shows route before you start running. Can customize direction, complexity, and view details.

### Live Tracking
GPS tracks your actual path (green line) vs planned route (blue dashed line).

## Common Tasks

### Change Default Distance
**File:** `Constants.swift`  
**Line:** `AppConstants.Routing.defaultDistance`  
**Change:** `5.0` to your preferred default

### Change App Colors
**File:** `Constants.swift`  
**Section:** `extension Color`  
**Modify:** Color definitions in the extension

### Change Voice Prompts
**File:** `NavigationManager.swift`  
**Method:** `speakInstruction(_:)`  
**Modify:** Text passed to this method

### Add New Workout Type
**File:** `Models.swift`  
**Enum:** `WorkoutType`  
**Add:** New case + icon

### Adjust Route Complexity
**File:** `Constants.swift`  
**Line:** `AppConstants.Routing.waypointCount`  
**Range:** 3-12 (default: 4)

## Testing

### Simulator Testing
1. Use "City Run" or "Freeway Drive" location simulations
2. Features > Location > Custom Location
3. Routes will generate but won't track movement

### Device Testing
1. Must test on real iPhone
2. Go outside or walk around
3. Grant location permissions
4. Generate route and start tracking

### Test Locations
- **San Francisco**: Good for testing (lots of streets)
- **Central Park**: Good for park routes
- **Your neighborhood**: Most realistic

## Troubleshooting

### Route Won't Generate
**Problem:** No blue route appears  
**Solutions:**
- Check location permissions
- Verify internet connection (MapKit needs it)
- Try different distance
- Check console for MapKit errors

### App Crashes
**Problem:** Crash on launch  
**Solutions:**
- Clean build folder (‚åò + Shift + K)
- Check Info.plist has privacy keys
- Verify deployment target is iOS 17+

### Voice Not Working
**Problem:** No turn announcements  
**Solutions:**
- Check voice guidance toggle is ON
- Verify phone isn't on silent
- Check speech synthesis permissions

### Dark Mode Issues
**Problem:** Colors look wrong  
**Solutions:**
- Use semantic colors (.appTextPrimary)
- Never use hardcoded colors
- Test in both light and dark mode

### Build Errors
**Problem:** "Cannot find type X"  
**Solutions:**
- Type must be defined in existing file
- Check imports (SwiftUI, MapKit)
- Verify file is in Xcode target

## Architecture Overview

### MVVM Pattern
- **Models**: Data structures (Run, RouteDetails)
- **Views**: SwiftUI views (ContentView, MapView)
- **ViewModels**: Managers (RoutePlanner, LocationManager)

### Key Managers

**RoutePlanner**
- Generates routes
- Calculates route details
- Manages waypoints

**LocationManager**
- Tracks GPS location
- Calculates distance & pace
- Records path

**NavigationManager**
- Detects turns
- Provides voice guidance
- Coaches pace

**SettingsManager**
- Stores user preferences
- Manages units (km/miles)

### Data Flow
```
User Action ‚Üí ContentView ‚Üí Manager ‚Üí Model ‚Üí Update UI
```

## Configuration

### App Constants
**File:** `Constants.swift`

**Routing:**
- `defaultDistance` - Initial distance (5.0 km)
- `minDistance` - Minimum route (1.0 km)
- `maxDistance` - Maximum route (50.0 km)
- `waypointCount` - Default waypoints (4)

**Location:**
- `distanceFilter` - GPS update frequency (10m)
- `mapZoomMeters` - Map zoom level (1000m)

**Navigation:**
- `instructionDistance` - When to announce turn (50m)
- `speechRate` - Voice speed (0.5)

**Pace:**
- `paceTolerancePercent` - Coaching threshold (10%)
- `minTimeBetweenCoaching` - Coaching frequency (120s)

### Colors
All colors defined in `Constants.swift` extension:
- Background colors (appBackground, appCardBackground)
- Text colors (appTextPrimary, appTextSecondary)
- Accent colors (appSuccess, appWarning, appDanger, appInfo)
- Running colors (paceOnTrack, paceSlightlyOff, paceFarOff)

## Permissions

### Required Permissions
1. **Location (When In Use)** - Required for route generation and tracking
2. **Location (Always)** - Optional, for background tracking
3. **Motion & Fitness** - For step counting and motion data
4. **HealthKit** - Optional, for saving workouts

### Privacy Strings
Must be in Info.plist with clear descriptions of why each permission is needed.

## Dependencies

### Apple Frameworks
- SwiftUI - UI framework
- MapKit - Maps and directions
- CoreLocation - GPS tracking
- HealthKit - Workout integration
- AVFoundation - Voice synthesis
- SwiftData - Data persistence
- Charts - Elevation charts (iOS 16+)

### No External Dependencies
App uses only native Apple frameworks. No CocoaPods, SPM, or Carthage needed.

## Performance Considerations

### Route Generation
- Limited to 12 waypoints max (API constraint)
- Cached to avoid regeneration
- Async operations prevent UI blocking

### GPS Tracking
- 10m distance filter (balances accuracy and battery)
- Only active during runs
- Stops when app backgrounds

### Map Display
- Removes old overlays before adding new
- Limits annotations
- Efficient rendering

## Next Steps

### For Development
1. Read `Documentation/AI_AGENT_GUIDE.md` for codebase overview
2. Read `Documentation/PROJECT_ARCHITECTURE.md` for architecture details
3. Explore individual feature docs in `Documentation/`

### For Users
1. Grant location permissions
2. Generate a route
3. Start running!

### For Contributors
1. Follow SwiftUI best practices
2. Use semantic colors
3. Document changes
4. Test in light and dark mode

## Resources

### Documentation
- `AI_AGENT_GUIDE.md` - For AI assistants
- `PROJECT_ARCHITECTURE.md` - Architecture details
- `ROUTE_PLANNING.md` - Route generation
- `DARK_MODE.md` - Dark mode implementation

### Apple Docs
- [SwiftUI Documentation](https://developer.apple.com/documentation/swiftui)
- [MapKit Documentation](https://developer.apple.com/documentation/mapkit)
- [CoreLocation Documentation](https://developer.apple.com/documentation/corelocation)
- [HealthKit Documentation](https://developer.apple.com/documentation/healthkit)

## Support

### Common Questions

**Q: Why circular routes?**
A: Always return to start - no need to figure out how to get back!

**Q: Can I save favorite routes?**
A: Not yet - coming in future version

**Q: Does it work offline?**
A: Route generation needs internet. Tracking works offline.

**Q: Can I share routes?**
A: Not yet - coming in future version

**Q: Why 12 waypoint limit?**
A: MapKit API restrictions and performance

### Getting Help
1. Check `Documentation/TROUBLESHOOTING.md`
2. Review console logs in Xcode
3. Check MapKit API responses
4. Verify permissions granted

## Version Info

- **Current Version**: 1.0
- **Min iOS**: 17.0
- **Language**: Swift 5.9+
- **Framework**: SwiftUI

---

## Quick Commands

```bash
# Build
‚åò + B

# Run
‚åò + R

# Clean
‚åò + Shift + K

# Test on device
Select device ‚Üí ‚åò + R

# View documentation
Open Documentation/ folder
```

## Summary

RunZone is a circular running route planner built with SwiftUI and MapKit. It generates routes, tracks runs, provides voice navigation, and saves workouts to Apple Health. The codebase follows MVVM architecture with clear separation between Models, Views, and Managers. All configuration is centralized in Constants.swift, and the app supports dark mode throughout.

**Start here**: Open ContentView.swift to see the main app screen and understand the overall structure. Then explore individual managers to understand specific features.

Happy running! üèÉ‚Äç‚ôÇÔ∏è
